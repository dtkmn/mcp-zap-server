spring:
  ai:
    mcp:
      server:
        name: mcp-zap-server
        version: 0.2.1-SNAPSHOT
        instructions: "Use this server to interact with the ZAP API for security testing."
        protocol: streamable
        resource-change-notification: true
        tool-change-notification: true
        prompt-change-notification: true
        streamable-http:
          keep-alive-interval: 30s
        type: async

logging:
  level:
    mcp.server.zap.service: DEBUG
    mcp.server.zap.configuration: INFO
    
server:
  port: 7456

# MCP Server Security Configuration
# Authentication Modes:
#   - none: No authentication (default - suitable for local development/STDIO transport)
#   - api-key: Simple API key authentication (suitable for trusted environments)
#   - jwt: JWT token-based authentication (recommended for production)
mcp:
  server:
    security:
      # Set authentication mode: none, api-key, or jwt
      mode: ${MCP_SECURITY_MODE:none}
      enabled: ${MCP_SECURITY_ENABLED:false}
    
    # Legacy single API key (for backward compatibility)
    apiKey: ${MCP_API_KEY:changeme-default-key}
    
    # Multi-Client API Key Configuration
    auth:
      apiKeys:
        - clientId: ${MCP_CLIENT_ID:default-client}
          key: ${MCP_API_KEY:changeme-default-key}
          description: ${MCP_CLIENT_DESCRIPTION:Default MCP client}
      
      # JWT Token Configuration
      jwt:
        enabled: ${JWT_ENABLED:false}
        secret: ${JWT_SECRET:jwt-secret-key-please-change-this-to-a-secure-random-value}
        issuer: ${JWT_ISSUER:mcp-zap-server}
        accessTokenExpiry: ${JWT_ACCESS_TOKEN_EXPIRATION:3600}
        refreshTokenExpiry: ${JWT_REFRESH_TOKEN_EXPIRATION:604800}

# ZAP Configuration
zap:
  server:
    url: ${ZAP_API_URL:localhost}
    port: ${ZAP_API_PORT:8090}
    apiKey: ${ZAP_API_KEY}
  
  scan:
    # Scan Limits and Timeouts
    limits:
      maxActiveScanDurationInMins: ${ZAP_MAX_ACTIVE_SCAN_DURATION:30}
      maxSpiderScanDurationInMins: ${ZAP_MAX_SPIDER_SCAN_DURATION:15}
      maxConcurrentActiveScans: ${ZAP_MAX_CONCURRENT_ACTIVE_SCANS:3}
      maxConcurrentSpiderScans: ${ZAP_MAX_CONCURRENT_SPIDER_SCANS:5}
      threadPerHost: ${ZAP_THREAD_PER_HOST:10}
      hostPerScan: ${ZAP_HOST_PER_SCAN:5}
      connectionTimeoutInSecs: ${ZAP_CONNECTION_TIMEOUT:60}
      spiderThreadCount: ${ZAP_SPIDER_THREAD_COUNT:5}
      spiderMaxDepth: ${ZAP_SPIDER_MAX_DEPTH:10}
    
    # Active Scan Configuration
    active:
      enableAllScanners: true
      # enabledScannersPolicy: "Default Policy"
      # enabledScannersIds: "400012,40014"
    
    # URL Validation and Security
    url:
      allowLocalhost: ${ZAP_ALLOW_LOCALHOST:false}
      allowPrivateNetworks: ${ZAP_ALLOW_PRIVATE_NETWORKS:false}
      # Comma-separated list of allowed domains (wildcards supported: *.example.com)
      # If set, host must match whitelist AND still pass blacklist/private-network checks
      whitelist: ${ZAP_URL_WHITELIST:}
      # The default blacklist includes localhost and private network ranges
      blacklist: ${ZAP_URL_BLACKLIST:localhost,127.0.0.1,0.0.0.0,169.254.0.0/16,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16}
  
  report:
    directory: ${ZAP_REPORT_DIRECTORY:/zap/wrk}
  
  # ZAP Initialization Settings (applied at startup via Network API)
  initialization:
    userAgent: ${ZAP_USER_AGENT:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36}
    connectionTimeoutInSecs: ${ZAP_INIT_CONNECTION_TIMEOUT:300}
    dnsTtlSuccessfulQueries: ${ZAP_DNS_TTL:60}

# Actuator Configuration
management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: never
